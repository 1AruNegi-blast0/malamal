"use strict";$(document).ajaxSend(function(elm,xhr,s){if(s.type=="POST"){xhr.setRequestHeader('x-csrf-token',getCookie('csrftoken'));}});var LoginUrl=(IB.debug)?'/new/login/or/register/':'https://'+window.location.host+'/new/login/or/register/';IB.views.ProductCardView=IB.views.BaseView.extend({template:_.template($('#AH_ProductCardTmpl').html()),events:{'click .AH_AddToCart':'addToCart','click .AH_AddToPurchaseBtn':'addToPurchaseList',},serialize:function(){return{type:this.type,product:this.productDetail,isFooterCard:this.isFooterCard,isProductWidget:this.isProductWidget,location:this.location}},addToCart:function(e){var sku=$(e.target).data("sku");var qty=$(e.target).data("qty");addToCart(sku,qty);if(IB.GA&&this.isFooterCard){ga("send","event","homePage_Sticky_"+this.location,"Click","Add_to_cart");}
if(IB.GA&&this.isProductWidget){ga("send","event","homePage_"+this.type,"Click","Add_to_cart");}},addToPurchaseList:function(e){var sku=$(e.target).data("sku");var qty=$(e.target).data("qty");listpagebuynow('',sku,qty);return;},afterRender:function(){lazyLoadImages();}});IB.views.ProductWidgetView=IB.views.BaseView.extend({events:{'click .AH_PreviousPageBtn':'getPreviousProducts','click .AH_NextPageBtn':'getNextProducts',},serialize:function(){return{type:this.type,items:this.items,sprite_image:this.sprite_image}},initialize:function(options){var self=this;self.options=options
self.type=self.options.type
self.template=_.template($(options.tmpl).html())
self.getData(self.options.id).then(function(res){res.result=_.filter(_.groupBy(res.result,function(item,ndx){return parseInt(ndx/res.item_per_page);}),function(i){return _.isArray(i)&&i.length===res.item_per_page;});if(res.result.length>0){self.sprite_image=res.sprite_image;self.items=res;self.render();}});},getData:function(id){var url="/api/homepage-widget/"+id+"/";return $.ajax({url:url})},afterRender:function(){var self=this;if(self.type=='product_widget'){_.each(this.items.result,function(group,ndx){_.each(group,function(product,index){product.url=product.cat.slug+'-'+product.brand.slug+'-'+product.sku;product.price.offerPrice=product.price.offerPrice*product.moq;product.price.price=product.price.price*product.moq;new IB.views.ProductCardView({el:self.$('.AH_ProductCard_'+ndx+'_'+index),productDetail:product,isProductWidget:true,type:self.type}).render();});});}
this.$('#AH_CarouselWidget_'+this.items.id).carousel({interval:false,wrap:false,});lazyLoadImages();},getNextProducts:function(){this.$('#AH_CarouselWidget_'+this.items.id).carousel('next');},getPreviousProducts:function(){this.$('#AH_CarouselWidget_'+this.items.id).carousel('prev');},});$(document).ready(function(){$(document).ajaxStart(function(){$("#ajaxBusy").hide();});$(document).ajaxStop(function(){$("#ajaxBusy").hide();});$(".topBar").css("position","fixed").removeClass("AH_Header").find(".logo").removeClass("logo-inn-fix");if(window.localStorage.getItem("footer-login-type")=="quickorder"){$(".AH_stickyOverlay").show();$("body").addClass("disbale-scroll");$(".footer-sticky").css("z-index","10000");$("#qo").addClass("active");$("#quickOrderContent").show();if(IB.globals.is_authenticated){IB.globals.views.quickOrderItemView=new IB.views.QuickOrderItemView;window.localStorage.clear()}}
$.each(window.widgets,function(i,elem){if(elem.type=="p"){new IB.views.ProductWidgetView({el:"#widget_"+elem.priority,id:elem.id,type:"product_widget",tmpl:"#productWidgetTmpl"})}
if(elem.type=="b"){new IB.views.ProductWidgetView({el:"#widget_"+elem.priority,id:elem.id,type:"banner_widget",tmpl:"#bannerWidgetTmpl"})}
if(elem.type=="c"){new IB.views.ProductWidgetView({el:"#widget_"+elem.priority,id:elem.id,type:"category_widget",tmpl:"#categoryWidgetTmpl"})}
if(elem.type=="br"){new IB.views.ProductWidgetView({el:"#widget_"+elem.priority,id:elem.id,type:"browseCategory",tmpl:"#browseByCategoryWidgetTmpl"})}});$(window).on("scroll",function(){var currPos=$(window).scrollTop();if($(window).scrollTop()>=$("footer").position().top-window.innerHeight+50){$('.leftNavContainer').css({"top":$(".footer-wrapper").position().top-$(".leftNavContainer").height()+56,"position":"absolute"});$(".footer-sticky").css({"position":"relative"});}
else{$(".rightArea").css("margin-left","260px");$(".footer-sticky").css({"position":"fixed","top":""})
$('.leftNavContainer').css({"top":"69px","position":"fixed"});}});$("#AH_allCatHomePage").click(function(e){e.preventDefault();var url=window.location.origin+'/categories/';history.pushState(IB.globals.result,null,url);$("#AH_ViewAllCategory").show()});$(".closeCategory").click(function(e){var url=window.location.origin;history.pushState(IB.globals.result,null,url);$("#AH_ViewAllCategory").hide()});$("#AH_mainBaner").carousel();$(".trackGA").click(function(e){e.preventDefault();if(IB.GA){var val=$(this).attr('data-val');ga("send","event","Home_Page_Banner","Click",val);}
if($(this).find("a").attr('href')){if($(this).find("a").attr('target')=="_blank")
window.open($(this).find("a").prop('href'),'_blank');else
window.location=$(this).find("a").prop('href');}});function hasDuplicate(arr){return(arr.length!=_.uniq(arr).length);};var PHONE_REGEX=/^\d{10,12}$/;$('.AH_newsLetterForm').on('submit',function(e){e.preventDefault();$('.AH_sub_result').text("").addClass('hide');var phone=$('.AH_phone_no').val().trim();if(!phone){$('.AH_sub_result').text("please enter phone").removeClass('hide');return;}else if(phone&&!PHONE_REGEX.test(phone)){$('.AH_sub_result').text("please enter correct phone").removeClass('hide');return;}
$.ajax({url:"/user/query-data/",type:"POST",data:{"source":"homepage","phone_number":phone},success:function(data,statusText,xhr){if(xhr.status===200){$('.AH_sub_result').text("thanks for subscribing").addClass('success-msg').removeClass('hide error-mssg');$("#AH_newsLetterView").remove();$("#AH_TopNewsLetterThanks").fadeIn();}},error:function(err){$('.AH_sub_result').text("server error occured").removeClass('hide');}});});});IB.views.BrandsByCategory=IB.views.BaseView.extend({template:_.template($('#AH_BrandByCategoryTmpl').html()),initialize:function(){},getBrands:function(){var that=this;$.ajax({type:'GET',url:'/featured-brands-category/',success:function(res){that.result=res;IB.views.BrandsByCategory.allCategoryBrands=Object.assign.apply(Object,that.result);that.getBrandByCategory();},error:function(error){console.log(error);}});},getBrandByCategory:function(){var brands=IB.views.BrandsByCategory.allCategoryBrands[this.id];var response=_.map(brands,function(item){item.imageUrl="http://"+IB.cloudFrontHost+'/'+item.brand_logo;;return item;})
this.brands=response;this.render();},afterRender:function(){lazyLoadImages();},serialize:function(){return{brands:this.brands,};}})
IB.views.StickyRecentlyView=IB.views.BaseView.extend({template:_.template($("#AH_RecentlyViewedContentTmpl").html()),events:{'click .AH_PreviousPageBtn':'getPreviousProducts','click .AH_NextPageBtn':'getNextProducts',},serialize:function(){return{items:this.items,location:this.location};},initialize:function(){var self=this;self.getRecentlyViewed().then(function(res){self.items=res;if(self.items.length>0){$("#rvi").html("Recently Viewed Items ("+self.items.length+")")}
self.items=_.filter(_.groupBy(self.items,function(item,ndx){return parseInt(ndx/4);}),function(i){return _.isArray(i);});self.render();},function(err){console.log(err);});},afterRender:function(){var self=this;_.each(this.items,function(item,ndx){_.each(item,function(product,index){product.url=product.cat.slug+'-'+product.brand.slug+'-'+product.sku;product.price.offerPrice=product.price.offerPrice*product.moq;product.price.price=product.price.price*product.moq;new IB.views.RecentlyProductCardView({el:self.$('.AH_ProductCard_'+ndx+'_'+index),productDetail:product,isFooterCard:true,location:"recently_viewed"}).render();});});this.$('.AH_CarouselWidget').carousel({interval:false,wrap:false,});},getNextProducts:function(){this.$('.AH_CarouselWidget').carousel('next');},getPreviousProducts:function(){this.$('.AH_CarouselWidget').carousel('prev');},getRecentlyViewed:function(){var url="/getrecentproducts/";return $.ajax({url:url,type:"GET"})},});IB.views.RecentlyProductCardView=IB.views.BaseView.extend({template:_.template($("#AH_RecentlyProductCardTmpl").html()),events:{'click .AH_AddToCart':'addToCart','click .AH_AddToPurchaseBtn':'addToPurchaseList',},serialize:function(){return{type:this.type,product:this.productDetail,isFooterCard:this.isFooterCard,isProductWidget:this.isProductWidget,location:this.location}},addToCart:function(e){var sku=$(e.target).data("sku");var qty=$(e.target).data("qty");addToCart(sku,qty);if(IB.GA&&this.isFooterCard){ga("send","event","homePage_Sticky_"+this.location,"Click","Add_to_cart");}
if(IB.GA&&this.isProductWidget){ga("send","event","homePage_"+this.type,"Click","Add_to_cart");}},addToPurchaseList:function(e){var sku=$(e.target).data("sku");var qty=$(e.target).data("qty");listpagebuynow('',sku,qty);},afterRender:function(){lazyLoadImages();}});$(function(){IB.globals.views.stickyRecentlyView=new IB.views.StickyRecentlyView({el:"#recentlyViewedContent"})})